---
name: add-chunk-size-validation
title: Add validation for chunk_size parameter in FileHasher to prevent incorrect hashes
status: open
created: 2026-01-21T09:18:28Z
updated: 2026-01-21T09:22:45Z
size: S
hours: 2
parallel: false
dependencies: []
---

# Issue #78: Add chunk_size validation in FileHasher

## Description

The FileHasher class accepts any chunk_size value without validation, allowing zero or negative values that cause incorrect hash computation.

## Current Problem

**Incorrect Hashes with Invalid chunk_size**:
- chunk_size = 0: Returns empty bytes, hash of empty file
- chunk_size = -1: Reads entire file at once (memory issue)
- Data Integrity: Files with same content get different hashes
- Duplicate Detection: Fails to identify duplicates correctly
- Silent Failure: No error raised, just wrong results

## Proposed Solution

Add validation in __init__:
- Check chunk_size > 0
- Raise ValueError with clear message
- Optional: isinstance(chunk_size, int) check

## Acceptance Criteria

- [ ] Add validation for chunk_size > 0 in __init__
- [ ] Raise ValueError with clear message for invalid values
- [ ] Optional: Add isinstance(chunk_size, int) check
- [ ] Update docstring to document the constraint
- [ ] Add test cases for invalid values
- [ ] Verify hash correctness after fix

## Technical Details

**File**: `src/file_organizer/services/deduplication/hasher.py` (line 35)
**Priority**: High (data integrity issue)
**Fix Complexity**: Low (5-10 lines)

## References

- CodeRabbit PR #67 review comment (2026-01-21)
