---
name: fix-doc-format-support
title: Remove misleading .doc support or implement real legacy .doc extraction
status: open
created: 2026-01-21T09:18:28Z
updated: 2026-01-21T09:22:45Z
size: M
hours: 8
parallel: false
dependencies: []
---

# Issue #77: Fix misleading .doc format support

## Description

The text extractor advertises support for legacy .doc files but uses python-docx which only supports Word 2007+ .docx (Open XML) format.

## Current Problem

- Silent Failures: .doc files fail to extract, log error, return empty string
- Misleading API: Users expect .doc support based on documentation
- python-docx limitation: Library only supports .docx, not legacy binary .doc

## Decision Required

**Option 1**: Remove .doc Support (Recommended - Simple)
- Remove .doc from docstring, supported_extensions, routing logic

**Option 2**: Add Real .doc Support (Complex)
- Requires external tools: antiword, unoconv/LibreOffice, textract
- Cross-platform support needed

## Acceptance Criteria

**If Option 1** (Remove):
- [ ] Remove .doc from docstring
- [ ] Remove .doc from supported_extensions
- [ ] Update routing logic to exclude .doc
- [ ] Add test verifying .doc raises ValueError
- [ ] Update documentation

**If Option 2** (Implement):
- [ ] Add new _extract_doc() method
- [ ] Add required dependencies
- [ ] Update routing to call correct extractor
- [ ] Add tests for both .doc and .docx
- [ ] Error handling for missing tools
- [ ] Cross-platform support

## Technical Details

**File**: `src/file_organizer/services/deduplication/extractor.py` (line 66)
**Priority**: High (misleading API)

## References

- CodeRabbit PR #67 review comment (2026-01-21)
- python-docx docs: https://python-docx.readthedocs.io/en/latest/user/documents.html
