---
name: add-cad-file-support
title: Add CAD file support
github_issue: 30
status: closed
size: L
hours: 24
parallel: true
depends_on: []
created: 2026-01-21T05:39:22Z
updated: 2026-01-24T07:05:36Z
---

# Task 013: Add CAD file support

## Description
Implement support for CAD (Computer-Aided Design) file formats including DWG and DXF. Extract CAD-specific metadata such as drawings, layers, dimensions, and generate preview images for CAD files.

## Objectives
- Support DWG format (AutoCAD native format)
- Support DXF format (Drawing Exchange Format)
- Extract CAD metadata (drawings, layers, dimensions)
- Generate preview images for CAD files

## Technical Details

### DWG Support
- Parse DWG file structure
- Extract drawing information
- Handle different DWG versions
- Extract block definitions and references

### DXF Support
- Parse DXF file format (ASCII and Binary)
- Extract entity information
- Parse layer definitions
- Extract dimension information

### Metadata Extraction
- Extract drawing properties (title, author, creation date)
- List all layers and their properties
- Extract dimension values and annotations
- Parse block library and references
- Extract viewport information
- Get drawing units and scale

### Preview Generation
- Generate thumbnail images from CAD drawings
- Convert specific layers to images
- Handle different viewport configurations
- Support zooming to extents

## Files to Modify
- `file_organizer_v2/src/file_organizer/models/cad_processor.py` (new)
- `file_organizer_v2/src/file_organizer/services/file_processor.py`
- `file_organizer_v2/src/file_organizer/utils/preview_generator.py` (new)

## Testing Requirements
- Test with DWG files from different AutoCAD versions
- Test with both ASCII and Binary DXF files
- Test metadata extraction accuracy
- Test preview generation quality
- Test with complex drawings (multiple layers, blocks)
- Test performance with large CAD files

## Dependencies
- ezdxf library for DXF parsing
- ODA File Converter or ezdxf for DWG support
- matplotlib or PIL for preview generation
- Consider using pyautocad if available

## Success Criteria
- Successfully parse DWG and DXF files
- Accurately extract CAD metadata (layers, dimensions, properties)
- Generate clear preview images
- Handle various CAD file versions
- Provide meaningful error messages for corrupted files

## Notes
- DWG is a proprietary format - may need external converter or library
- DXF is an open format and easier to parse
- Preview generation may require significant processing for complex drawings
- Consider memory usage with large CAD files
- May need to handle coordinate system transformations
