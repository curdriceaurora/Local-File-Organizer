---
name: build-audio-content-organization
title: Build audio content-based organization
status: open
size: M
hours: 16
parallel: false
depends_on: [42, 43]
created: 2026-01-21T05:39:23Z
updated: 2026-01-21T05:45:29Z
---

# Task 003: Build audio content-based organization

## Description

Implement intelligent content-based organization for audio files using both transcribed content and metadata. This task creates smart categorization to distinguish between music, podcasts, recordings, and other audio types, then organizes them into logical folder structures based on their content and characteristics.

## Acceptance Criteria

- [ ] Automatically categorize audio files by type (music, podcast, recording, audiobook, etc.)
- [ ] Organize music files by artist, album, and genre
- [ ] Organize podcasts by show name, episode number, and date
- [ ] Organize voice recordings by date, topic, and speakers
- [ ] Create folder structure automatically based on audio type
- [ ] Use transcribed content for topic-based organization
- [ ] Support custom organization rules and templates
- [ ] Handle duplicate detection and consolidation
- [ ] Provide organization preview before moving files
- [ ] Generate organization reports with statistics
- [ ] Support batch organization with progress tracking
- [ ] Integration tests with complete organization workflows

## Technical Details

### Implementation Approach

1. **Audio Type Classification**
   - Analyze metadata patterns to determine type
   - Use transcription content for context
   - Machine learning classifier for ambiguous cases
   - Rule-based classification for clear patterns

   **Classification Rules:**
   - **Music**: Has artist/album tags, short tracks (<10 min), no speech
   - **Podcast**: Episode metadata, 15-90 min duration, conversational speech
   - **Audiobook**: Chapter metadata, long duration (>30 min), narrative speech
   - **Voice Recording**: No metadata, variable length, often meeting/memo keywords
   - **Interview**: Multiple speakers, Q&A pattern in transcription

2. **Organization Strategies**

   **Music Organization:**
   ```
   Music/
   ├── {Genre}/
   │   └── {Artist}/
   │       └── {Album}/
   │           └── {TrackNum} - {Title}.{ext}
   ```

   **Podcast Organization:**
   ```
   Podcasts/
   ├── {Show Name}/
   │   └── {Year}/
   │       └── {Episode} - {Title} ({Date}).{ext}
   ```

   **Recording Organization:**
   ```
   Recordings/
   ├── {Year}/
   │   └── {Month}/
   │       └── {Topic or Keywords}/
   │           └── {Date} - {Description}.{ext}
   ```

3. **Content Analysis Integration**
   - Use transcription to extract topics and keywords
   - Apply NLP for topic modeling
   - Extract dates and event names from speech
   - Identify speaker names for attribution

4. **Smart Folder Creation**
   - Generate folder names from metadata
   - Sanitize names for filesystem compatibility
   - Handle naming conflicts automatically
   - Maintain consistent naming conventions

5. **Duplicate Detection**
   - Compare audio fingerprints
   - Check metadata similarity
   - Identify re-encoded versions
   - Merge or flag duplicates

### File Structure
```
file_organizer_v2/src/file_organizer/
├── services/
│   ├── audio_classifier.py       # Type classification
│   ├── audio_organizer.py        # Main organization logic
│   └── audio_duplicate_detector.py  # Duplicate detection
├── core/
│   └── organization_rules.py     # Rule engine
└── utils/
    └── path_utils.py              # Path sanitization
```

### Key Classes

```python
class AudioClassifier:
    """Classify audio files by type"""

    def classify(
        self,
        metadata: AudioMetadata,
        transcription: Optional[TranscriptionResult] = None
    ) -> AudioType:
        """Determine audio file type"""

    def get_classification_confidence(self) -> float:
        """Return confidence score for classification"""


class AudioOrganizer:
    """Organize audio files based on content and metadata"""

    def __init__(self, rules: OrganizationRules):
        """Initialize with organization rules"""

    def preview_organization(
        self,
        files: List[str],
        base_path: str
    ) -> OrganizationPlan:
        """Preview how files will be organized"""

    def organize(
        self,
        files: List[str],
        base_path: str,
        dry_run: bool = True
    ) -> OrganizationResult:
        """Organize files according to rules"""

    def generate_path(
        self,
        audio_type: AudioType,
        metadata: AudioMetadata,
        transcription: Optional[TranscriptionResult] = None
    ) -> str:
        """Generate target path for audio file"""


class OrganizationRules:
    """Define organization rules and templates"""

    music_template: str = "{Genre}/{Artist}/{Album}/{TrackNum} - {Title}"
    podcast_template: str = "{Show}/{Year}/{Episode} - {Title}"
    recording_template: str = "Recordings/{Year}/{Month}/{Topic}/{Date}"

    def customize_template(self, audio_type: AudioType, template: str):
        """Set custom organization template"""
```

### Dependencies
- Task 001 (transcription) - required for content analysis
- Task 002 (metadata) - required for organization decisions
- librosa or audioflux (for audio fingerprinting)
- scikit-learn (for ML classification if needed)

### Performance Considerations
- Cache classification results
- Batch process multiple files
- Optimize path generation
- Parallelize duplicate detection
- Progress tracking for large batches

### User Experience
- Dry run mode to preview changes
- Confirmation prompts for large operations
- Detailed organization reports
- Undo/rollback capability
- Progress bars for batch operations

## Dependencies

- **Task 001**: Requires transcription functionality for content-based organization
- **Task 002**: Requires metadata extraction for classification and path generation

## Effort Estimate

**Size:** Medium (M)
**Estimated Hours:** 16 hours

### Breakdown:
- Audio type classification: 4 hours
- Organization rule engine: 3 hours
- Path generation and sanitization: 2 hours
- Content analysis integration: 3 hours
- Duplicate detection: 2 hours
- Testing and validation: 2 hours

## Definition of Done

- [ ] Code implemented and follows project style guidelines
- [ ] All acceptance criteria met
- [ ] Unit tests written and passing (>80% coverage)
- [ ] Integration tests with complete organization workflows
- [ ] Successfully classifies and organizes sample audio files
- [ ] Handles edge cases (missing metadata, corrupted files)
- [ ] Duplicate detection working accurately
- [ ] Dry run mode tested and functional
- [ ] Organization reports generated correctly
- [ ] Performance acceptable for large file sets (>1000 files)
- [ ] Code reviewed and approved
- [ ] Documentation with usage examples and templates
- [ ] No regression in existing functionality
- [ ] User-facing error messages clear and helpful
