---
name: add-para-smart-suggestions
title: Add PARA smart suggestions
status: open
size: L
hours: 24
parallel: false
depends_on: ["007", "008"]
overlap_analysis: 45%
existing_implementation: "Generic suggestion engine (567 LOC), confidence scoring, feedback framework"
missing_implementation: "AI integration (Claude API), PARA-specific logic, learning from corrections"
created: 2026-01-21T05:39:23Z
updated: 2026-01-26T00:52:32Z
github: 
---

# Task 009: Add PARA smart suggestions

## Description

Implement AI-powered smart suggestions for PARA categorization, including content analysis, user feedback loops for continuous improvement, and PARA-aware file movement capabilities. This is the intelligence layer on top of the PARA system.

## ⚡ Implementation Overlap Analysis (45% Complete)

**What's Already Implemented:**
- ✅ `smart_suggestions.py` (567 LOC) - Complete generic suggestion framework
- ✅ `ConfidenceScorer` class with 7 scoring factors
- ✅ `SuggestionEngine` with move/rename/restructure suggestions
- ✅ `suggestion_feedback.py` - Feedback collection framework
- ✅ `pattern_analyzer.py` - Pattern extraction
- ✅ Integration with text model for explanations

**What's Missing (55%):**
- ❌ AI-powered PARA-specific suggestions using Claude API or local LLMs
- ❌ Feedback loop integration with PARA categorization engine
- ❌ Learning from user corrections and preferences
- ❌ Adaptive threshold adjustments based on historical accuracy
- ❌ PARA-specific confidence scoring (not generic)
- ❌ Multi-category suggestion scenarios
- ❌ Explanation generation specific to PARA logic
- ❌ User override history tracking and analytics

**Priority: FULL IMPLEMENTATION NEEDED** - Integrate AI models with PARA engine for context-aware suggestions

## Objectives

- Implement AI-powered content analysis for accurate categorization
- Create user feedback mechanism for improving suggestions
- Build PARA-aware file movement system
- Develop confidence scoring and explanation features
- Enable learning from user corrections

## Requirements

### AI-Powered Content Analysis

**Analysis Capabilities:**
1. **Text Content Analysis:**
   - Extract key phrases and topics
   - Identify temporal indicators (deadlines, dates)
   - Detect project vs reference language
   - Recognize completion markers

2. **Document Structure Analysis:**
   - Identify document type (report, checklist, guide, etc.)
   - Analyze heading structure
   - Detect task lists and action items
   - Recognize reference formatting

3. **Metadata Enrichment:**
   - Creation and modification patterns
   - File relationship analysis
   - Usage frequency tracking
   - Version history patterns

4. **Multi-Modal Analysis:**
   - Text documents (PDF, DOCX, TXT, MD)
   - Spreadsheets (XLSX, CSV)
   - Images (OCR for scanned documents)
   - Email archives (MBOX, EML)

### Suggestion Engine

**Suggestion Types:**
```python
class PARASuggestion:
    category: PARACategory  # Suggested category
    confidence: float  # 0.0 to 1.0
    reasoning: List[str]  # Human-readable explanations
    alternative_categories: List[Tuple[PARACategory, float]]
    suggested_subfolder: Optional[str]
    tags: List[str]

class SuggestionEngine:
    def analyze_file(self, file_path: str) -> PARASuggestion:
        """Generate PARA suggestion for a file"""
        pass

    def batch_analyze(self, file_paths: List[str]) -> List[PARASuggestion]:
        """Analyze multiple files efficiently"""
        pass

    def explain_suggestion(self, suggestion: PARASuggestion) -> str:
        """Generate human-readable explanation"""
        pass
```

**Confidence Levels:**
- **High (0.85-1.0):** Auto-categorize with notification
- **Medium (0.60-0.84):** Suggest with user confirmation
- **Low (0.40-0.59):** Present multiple options
- **Very Low (<0.40):** Flag for manual review

### User Feedback Loop

**Feedback Collection:**
```python
class FeedbackCollector:
    def record_acceptance(self, file_id: str, suggestion: PARASuggestion):
        """User accepted suggestion"""
        pass

    def record_rejection(self, file_id: str, suggestion: PARASuggestion,
                         correct_category: PARACategory):
        """User corrected suggestion"""
        pass

    def record_modification(self, file_id: str, original: PARACategory,
                           modified: PARACategory, reason: str):
        """User moved file to different category"""
        pass
```

**Learning Mechanisms:**
1. **Pattern Recognition:**
   - Learn from user corrections
   - Identify user-specific categorization preferences
   - Adapt to organizational context

2. **Rule Refinement:**
   - Automatically suggest new rules based on patterns
   - Adjust rule weights based on accuracy
   - Deprecate ineffective rules

3. **Model Fine-Tuning:**
   - Periodic retraining with feedback data
   - User-specific model personalization
   - Transfer learning from similar users

### PARA-Aware File Movement

**Smart Movement Features:**
```python
class PARAFileMover:
    def suggest_move(self, file_path: str) -> MoveSuggestion:
        """Suggest optimal PARA location for file"""
        pass

    def move_with_context(self, file_path: str, target_category: PARACategory,
                          preserve_links: bool = True) -> MoveResult:
        """Move file while preserving context"""
        pass

    def bulk_organize(self, directory: str,
                      auto_approve: bool = False) -> OrganizationReport:
        """Organize entire directory with PARA"""
        pass

    def suggest_archive(self) -> List[ArchiveSuggestion]:
        """Suggest files that should be archived"""
        pass
```

**Context Preservation:**
- Update internal links and references
- Maintain file relationships
- Preserve tags and metadata
- Create breadcrumb trail
- Generate move history

**Batch Operations:**
- Organize entire directories
- Smart grouping of related files
- Conflict detection and resolution
- Progress tracking with preview

## Implementation Details

### Content Analysis Pipeline

**Stage 1: Feature Extraction**
```python
class FeatureExtractor:
    def extract_text_features(self, content: str) -> Dict[str, Any]:
        """Extract text-based features"""
        return {
            'keywords': self.extract_keywords(content),
            'temporal_indicators': self.find_dates_and_deadlines(content),
            'structure': self.analyze_structure(content),
            'sentiment': self.analyze_tone(content)
        }

    def extract_metadata_features(self, file_path: str) -> Dict[str, Any]:
        """Extract file metadata features"""
        return {
            'creation_date': ...,
            'modification_pattern': ...,
            'size': ...,
            'file_type': ...
        }
```

**Stage 2: AI Model Integration**
```python
class PARAClassifier:
    def __init__(self, model_path: str):
        self.model = self.load_model(model_path)
        self.feature_extractor = FeatureExtractor()

    def predict_category(self, features: Dict[str, Any]) -> CategoryPrediction:
        """Predict PARA category with confidence"""
        pass

    def explain_prediction(self, features: Dict[str, Any],
                          prediction: CategoryPrediction) -> List[str]:
        """Generate explanation for prediction"""
        pass
```

**Stage 3: Rule-Based Refinement**
```python
class HybridCategorizer:
    def __init__(self, ai_model: PARAClassifier, rule_engine: RuleEngine):
        self.ai_model = ai_model
        self.rule_engine = rule_engine

    def categorize(self, file_path: str) -> PARASuggestion:
        """Combine AI and rule-based categorization"""
        ai_suggestion = self.ai_model.predict_category(features)
        rule_suggestion = self.rule_engine.categorize(file_path)

        return self.merge_suggestions(ai_suggestion, rule_suggestion)
```

### Feedback Learning System

**Data Collection:**
```python
class FeedbackDatabase:
    def store_feedback(self, feedback: UserFeedback) -> None:
        """Store user feedback for learning"""
        pass

    def get_training_data(self, min_confidence: float = 0.8) -> Dataset:
        """Extract high-quality training data from feedback"""
        pass

    def analyze_patterns(self) -> Dict[str, PatternAnalysis]:
        """Analyze feedback patterns for insights"""
        pass
```

**Continuous Learning:**
```python
class ContinuousLearner:
    def __init__(self, model: PARAClassifier, feedback_db: FeedbackDatabase):
        self.model = model
        self.feedback_db = feedback_db
        self.retraining_threshold = 100  # feedbacks

    def check_and_retrain(self) -> bool:
        """Check if retraining is needed and execute"""
        feedback_count = self.feedback_db.count_new_feedback()
        if feedback_count >= self.retraining_threshold:
            return self.retrain_model()
        return False

    def retrain_model(self) -> bool:
        """Retrain model with accumulated feedback"""
        pass
```

### User Interface Components

**Suggestion Display:**
```
┌─────────────────────────────────────────────────┐
│ PARA Suggestion for: project-proposal.docx     │
├─────────────────────────────────────────────────┤
│ Recommended: Projects/Active                   │
│ Confidence: 92%                                │
│                                                │
│ Reasoning:                                     │
│ • Contains deadline mentions (Due: March 15)   │
│ • Active task list with incomplete items       │
│ • Modified 3 times this week                   │
│ • "Proposal" indicates active project          │
│                                                │
│ Alternative: Areas/Professional (35%)          │
│                                                │
│ [Accept] [Choose Different] [Learn More]      │
└─────────────────────────────────────────────────┘
```

**Bulk Organization UI:**
```
Analyzing 247 files...
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100%

PARA Organization Summary:
├── Projects (45 files)
│   ├── High confidence: 38
│   └── Needs review: 7
├── Areas (82 files)
│   ├── High confidence: 76
│   └── Needs review: 6
├── Resources (95 files)
│   ├── High confidence: 90
│   └── Needs review: 5
└── Archive candidates (25 files)
    └── Inactive for 6+ months

[Review Suggestions] [Auto-Organize High Confidence] [Cancel]
```

## Acceptance Criteria

- [ ] AI content analysis accurately categorizes files (>85% accuracy)
- [ ] Suggestions include clear, understandable reasoning
- [ ] Confidence scores accurately reflect categorization certainty
- [ ] User feedback successfully collected and stored
- [ ] Learning system improves accuracy over time
- [ ] PARA-aware file movement preserves context
- [ ] Batch organization handles large directories efficiently
- [ ] Archive suggestions identify inactive files correctly
- [ ] UI provides clear, actionable suggestions
- [ ] Performance acceptable for real-time suggestions (<2s per file)
- [ ] All tests passing (>85% coverage)

## Testing Strategy

### Accuracy Testing
- Test with diverse file sets (1000+ files)
- Measure categorization accuracy
- Validate confidence score calibration
- Test across different file types

### Learning Testing
- Simulate user feedback cycles
- Measure accuracy improvement over time
- Test with different user patterns
- Validate model convergence

### Performance Testing
- Single file analysis (<2s)
- Batch processing (100 files <30s)
- Real-time suggestion latency
- Memory usage optimization

### User Experience Testing
- Suggestion clarity and usefulness
- Feedback mechanism usability
- Bulk operation workflow
- Error recovery

## Dependencies

- **Task 007**: PARA categorization system design
- **Task 008**: PARA folder generation implementation
- AI/ML model infrastructure (Claude API integration)
- Feedback storage system
- UI components for suggestion display

## Technical Notes

**AI Model Strategy:**
- Use Claude API for content analysis
- Implement local caching for performance
- Consider privacy-preserving on-device models
- Support offline mode with reduced accuracy

**Privacy Considerations:**
- All content analysis happens locally
- Optional cloud enhancement with user consent
- No file content sent to external services without permission
- Clear data usage policies

**Performance Optimizations:**
- Lazy loading of AI models
- Background processing for bulk operations
- Incremental analysis for large files
- Result caching with invalidation

**Explainability:**
- All suggestions must include reasoning
- Transparent confidence scoring
- User-friendly explanations
- Debug mode for advanced users

## Explanation Examples

**Project Categorization:**
```
Why this file belongs in Projects:
✓ Contains deadline "Complete by March 30, 2026"
✓ Has active task list with 8 incomplete items
✓ Modified 5 times in past 2 weeks
✓ Filename pattern matches "project-*"
✓ Contains milestone markers
```

**Archive Suggestion:**
```
Consider archiving this file:
• Last modified 8 months ago
• Contains "FINAL" in filename
• Associated project marked as completed
• No recent access logs
• Similar files already archived
```

## Resources

- Claude API documentation
- PARA methodology case studies
- Machine learning best practices
- UX patterns for AI suggestions
- Explainable AI techniques
