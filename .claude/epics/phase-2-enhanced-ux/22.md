---
name: Design and implement configuration system
status: open
created: 2026-01-21T05:26:55Z
updated: 2026-01-21T05:35:26Z
github: https://github.com/curdriceaurora/Local-File-Organizer/issues/22
depends_on: [18]
parallel: false
conflicts_with: []
---

## Description

Design and implement a comprehensive YAML-based configuration system that allows users to customize the File Organizer's behavior. The system should support multiple configuration profiles, exclusion patterns, default settings, validation, and easy loading/saving of configurations.

## Acceptance Criteria

- [ ] YAML configuration schema designed and documented
- [ ] Configuration loading from file implemented
- [ ] Configuration saving to file implemented
- [ ] Input validation with helpful error messages
- [ ] Default configuration provided
- [ ] Support for multiple user profiles
- [ ] Exclusion patterns (files/folders to skip) supported
- [ ] Configuration merging (defaults + user overrides)
- [ ] Unit tests for all configuration operations
- [ ] Documentation with configuration examples

## Technical Details

### Configuration Schema Design

**Core Configuration Structure:**
```yaml
version: "2.0"
profiles:
  default:
    scan_paths:
      - ~/Documents
      - ~/Downloads
    exclusions:
      patterns:
        - "*.tmp"
        - ".git/*"
        - "node_modules/*"
      folders:
        - ".cache"
        - "__pycache__"
    models:
      vision: gemini-2.0-flash-exp
      text: gemini-2.0-flash-thinking-exp
      embedding: text-embedding-004
    organization:
      create_folders: true
      dry_run: false
      batch_size: 50
    ui:
      theme: auto
      show_previews: true
      verbose: false
```

### Implementation Components

**Config Manager Class:**
- `load_config(path: Path) -> Config`
- `save_config(config: Config, path: Path)`
- `validate_config(config: Config) -> ValidationResult`
- `merge_configs(base: Config, override: Config) -> Config`
- `get_default_config() -> Config`

**Validation Rules:**
- Check version compatibility
- Validate scan paths exist
- Verify model names are valid
- Ensure required fields present
- Type checking for all fields

**File Locations:**
- Default: `~/.config/file-organizer/config.yaml`
- Alternative: Specified via CLI flag `--config`
- Fallback: Built-in defaults if no config found

### Error Handling

- Invalid YAML syntax → Clear parsing error with line number
- Missing required fields → List missing fields with examples
- Invalid values → Suggest valid alternatives
- File not found → Auto-create with defaults (with user confirmation)

## Dependencies

**Depends on:**
- Task 001: Requires PyYAML dependency installed

**Blocks:**
- Task 003+: Most features will need configuration system

## Effort Estimate

- **Size:** M
- **Estimated Hours:** 16
- **Complexity:** Medium
- **Risk Level:** Low

**Breakdown:**
- Schema design and documentation: 3 hours
- Config loading/saving implementation: 4 hours
- Validation logic: 3 hours
- Profile and exclusion support: 3 hours
- Testing and edge cases: 2 hours
- Documentation and examples: 1 hour

## Definition of Done

- [ ] Configuration module implemented in `file_organizer_v2/src/file_organizer/config/`
- [ ] All CRUD operations for configs working
- [ ] Comprehensive unit tests (>90% coverage)
- [ ] Validation catches all common errors
- [ ] Default configuration provided and tested
- [ ] Multiple profiles can be loaded and switched
- [ ] Exclusion patterns properly filter files
- [ ] Documentation includes schema reference and examples
- [ ] Integration tested with existing file scanner
- [ ] No breaking changes to existing functionality
